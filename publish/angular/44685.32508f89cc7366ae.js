"use strict";(self.webpackChunkfandaqapp=self.webpackChunkfandaqapp||[]).push([[44685],{44685:(X,A,r)=>{r.r(A),r.d(A,{DEFAULT_GDPR_ENTITY_PROPS:()=>l,DEFAULT_GDPR_TOOLBAR_ACTIONS:()=>d,GdprActionColumnComponent:()=>D,GdprComponent:()=>h,GdprExtensionsGuard:()=>B,GdprModule:()=>z,RequestPersonalDataToolbarActionComponent:()=>T});var s=r(88762),g=r(69670),i=r(17557),t=r(19212),y=r(23758);let b=(()=>{class e{constructor(n){this.restService=n,this.apiName="Gdpr",this.deleteUserData=()=>this.restService.request({method:"DELETE",url:"/api/gdpr/requests"},{apiName:this.apiName}),this.getDownloadToken=o=>this.restService.request({method:"GET",url:"/api/gdpr/requests/download-token",params:{id:o}},{apiName:this.apiName}),this.getList=o=>this.restService.request({method:"GET",url:"/api/gdpr/requests/list",params:{userId:o.userId,sorting:o.sorting,skipCount:o.skipCount,maxResultCount:o.maxResultCount}},{apiName:this.apiName}),this.getUserData=(o,a)=>this.restService.request({method:"GET",responseType:"blob",url:`/api/gdpr/requests/data/${o}`,params:{token:a}},{apiName:this.apiName}),this.isNewRequestAllowed=()=>this.restService.request({method:"GET",url:"/api/gdpr/requests/is-request-allowed"},{apiName:this.apiName}),this.prepareUserData=()=>this.restService.request({method:"POST",url:"/api/gdpr/requests/prepare-data"},{apiName:this.apiName})}static#t=this.\u0275fac=function(o){return new(o||e)(t.LFG(s.vgb))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var P=r(32181),q=r(48180),f=r(37398),G=r(99397),C=r(65765),L=r(94664),O=r(22096),m=r(96814),R=r(32427);function S(e,p){1&e&&(t.TgZ(0,"span",3),t._uU(1),t.ALo(2,"abpLocalization"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"AbpGdpr::Preparing")))}function N(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.getUserData())}),t._uU(1),t.ALo(2,"abpLocalization"),t.qZA()}2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"AbpGdpr::Download")))}function E(e,p){1&e&&t.GkF(0)}function U(e,p){if(1&e&&(t.TgZ(0,"div",3),t.YNc(1,E,1,0,"ng-container",4),t.qZA()),2&e){t.oxw();const n=t.MAs(5),o=t.MAs(3);t.Q6J("ngbTooltip",n),t.xp6(1),t.Q6J("ngTemplateOutlet",o)}}function _(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.requestPersonalDataService.requestPersonalDate())}),t.ALo(1,"async"),t._uU(2),t.ALo(3,"abpLocalization"),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("disabled",t.lcZ(1,2,n.requestPersonalDataService.btnDisabled$)),t.xp6(2),t.hij(" ",t.lcZ(3,4,"AbpGdpr::RequestPersonalData")," ")}}function F(e,p){1&e&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"abpLocalization"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"AbpGdpr::Volo.Abp.Gdpr:010001")))}let v=(()=>{class e{constructor(n,o){this.list=n,this.gdprRequestService=o,this.store=new s.gSB(!1),this.btnDisabled$=this.store.sliceState(a=>!a)}requestPersonalDate(){this.gdprRequestService.prepareUserData().subscribe(()=>{this.list.get(),this.checkRequestAllowed()})}checkRequestAllowed(){this.gdprRequestService.isNewRequestAllowed().subscribe(n=>{this.store.patch(n)})}static#t=this.\u0275fac=function(o){return new(o||e)(t.LFG(s.XNV),t.LFG(b))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})(),h=(()=>{class e{get currentUserId(){return this.configState.getDeep("currentUser.id")}constructor(n,o,a,c,u,Q){this.list=n,this.service=o,this.configState=a,this.cdr=c,this.confirmation=u,this.requestPersonalDataService=Q,this.data={items:[],totalCount:0}}ngOnInit(){this.hookToQuery(),this.requestPersonalDataService.checkRequestAllowed()}deleteData(){this.confirmation.warn("AbpGdpr::DeletePersonalDataWarning","").pipe((0,P.h)(n=>n===g.Tv.Status.confirm)).subscribe(()=>this.deleteUserData())}deleteUserData(){this.service.deleteUserData().subscribe(()=>{this.list.get(),this.confirmation.success("AbpGdpr::PersonalDataDeleteRequestReceived","")})}hookToQuery(){const n=this.currentUserId;this.list.hookToQuery(o=>this.service.getList({...o,userId:n})).subscribe(o=>{this.data=o,this.cdr.detectChanges()})}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(s.XNV),t.Y36(b),t.Y36(s.XJE),t.Y36(t.sBO),t.Y36(g.YP),t.Y36(v))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["abp-gdpr"]],features:[t._Bn([s.XNV,{provide:i.ex,useValue:"Gdpr.GdprComponent"},v])],decls:8,vars:10,consts:[[3,"title","toolbar"],[1,"alert","alert-info"],[1,"mt-4"],[1,"card"],[3,"data","recordsTotal","list"]],template:function(o,a){1&o&&(t.TgZ(0,"abp-page",0),t.ALo(1,"abpLocalization"),t.TgZ(2,"p",1),t._uU(3),t.ALo(4,"abpLocalization"),t.qZA(),t.TgZ(5,"div",2)(6,"div",3),t._UZ(7,"abp-extensible-table",4),t.qZA()()()),2&o&&(t.Q6J("title",t.lcZ(1,6,"AbpGdpr::PersonalData"))("toolbar",a.data.items),t.xp6(3),t.Oqu(t.lcZ(4,8,"AbpGdpr::PersonalDataDescription")),t.xp6(4),t.Q6J("data",a.data.items)("recordsTotal",a.data.totalCount)("list",a.list))},dependencies:[i.m5,C.II,s.fuE],encapsulation:2})}return e})(),D=(()=>{class e{get apiUrl(){return this.environment.getApiUrl("Gdpr")}constructor(n,o,a,c){this.value$=n,this.environment=o,this.gdprRequestService=a,this.subscription=c,this.isReadyToDownload=!1}ngOnInit(){this.subscription.addOne(this.value$,n=>{this.isReadyToDownload=this.checkIsReadyToDownload(n.readyTime)})}getUserData(){this.value$.pipe((0,q.q)(1)).subscribe(n=>{this.checkIsReadyToDownload(n.readyTime)&&this.gdprRequestService.getDownloadToken(n.id).pipe((0,L.w)(o=>this.gdprRequestService.getUserData(n.id,o.token))).subscribe(o=>{(0,s.lmu)(o,"PersonalData")})})}checkIsReadyToDownload(n){return new Date(n)<new Date}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(i.Kg),t.Y36(s.L$R),t.Y36(b),t.Y36(s.FFO))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["abp-gdpr-action-column"]],features:[t._Bn([s.FFO])],decls:3,vars:2,consts:[[1,"pointer","abp-ellipsis-inline",2,"max-width","160px"],["class","badge bg-warning",4,"ngIf"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],[1,"badge","bg-warning"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(o,a){1&o&&(t.TgZ(0,"div",0),t.YNc(1,S,3,3,"span",1)(2,N,3,3,"button",2),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngIf",!a.isReadyToDownload),t.xp6(1),t.Q6J("ngIf",a.isReadyToDownload))},dependencies:[m.O5,s.fuE],encapsulation:2})}return e})();const x=i.QC.createMany([{type:"string",name:"action",displayName:"AbpGdpr::Action",sortable:!0,columnWidth:180,component:D,valueResolver:e=>(e=>(0,O.of)(e))(e.record)},{type:"datetime",name:"creationTime",displayName:"AbpGdpr::CreationTime",sortable:!0,columnWidth:200},{type:"datetime",name:"readyTime",displayName:"AbpGdpr::ReadyTime",sortable:!0,columnWidth:200}]);let T=(()=>{class e{constructor(n){this.requestPersonalDataService=n}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(v))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["abp-request-personal-data-toolbar-action"]],decls:6,vars:4,consts:[[3,"ngbTooltip",4,"ngIf","ngIfElse"],["btnTmp",""],["tooltipTmp",""],[3,"ngbTooltip"],[4,"ngTemplateOutlet"],["type","button",1,"btn","btn-sm","btn-primary",3,"disabled","click"]],template:function(o,a){if(1&o&&(t.YNc(0,U,2,2,"div",0),t.ALo(1,"async"),t.YNc(2,_,4,6,"ng-template",null,1,t.W1O)(4,F,3,3,"ng-template",null,2,t.W1O)),2&o){const c=t.MAs(3);t.Q6J("ngIf",t.lcZ(1,2,a.requestPersonalDataService.btnDisabled$))("ngIfElse",c)}},dependencies:[m.O5,m.tP,R._L,m.Ov,s.fuE],encapsulation:2,changeDetection:0})}return e})();const Z=[...i.nV.createMany([{component:T}]),...i.JE.createMany([{text:"AbpGdpr::DeletePersonalData",action:e=>{e.getInjected(h).deleteData()},btnClass:"btn btn-sm btn-danger"}])],l={"Gdpr.GdprComponent":x},d={"Gdpr.GdprComponent":Z},k=[{path:"",component:s.O39,canActivate:[s.p2e,s.zaK],resolve:[()=>{const e=(0,t.f3M)(t.zs3),p=e.get(i.X6),n=e.get(l,null)||{},o=e.get(d,null)||{},a=e.get(s.XJE);return(0,i.ot)(a,"Gdpr").pipe((0,f.U)(c=>({"Gdpr.GdprComponent":c.PersonalData})),(0,i.V_)(a,"AbpGdpr"),(0,G.b)(c=>{(0,i.Hp)(p.entityProps,l,c.prop,n),(0,i.Fr)(p.toolbarActions,d,o)}))}],children:[{path:"",component:s.c$y,data:{replaceableComponent:{defaultComponent:h,key:"Gdpr.GdprComponent"}}}]}];let J=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[y.Bz.forChild(k),y.Bz]})}return e})(),z=(()=>{class e{static forChild(n={}){return{ngModule:e,providers:[{provide:l,useValue:n.createFormPropContributors},{provide:d,useValue:n.toolbarActionContributors}]}}static forLazy(){return new s.Cgl(e.forChild())}static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[s.IR2,g.e2,J,i.hi,C.BG,R.HK]})}return e})(),B=(()=>{class e{constructor(n){this.injector=n}canActivate(){const n=this.injector.get(i.X6),o=this.injector.get(l,null)||{},a=this.injector.get(d,null)||{},c=this.injector.get(s.XJE);return(0,i.ot)(c,"Gdpr").pipe((0,f.U)(u=>({"Gdpr.GdprComponent":u.PersonalData})),(0,i.V_)(c,"AbpGdpr"),(0,G.b)(u=>{(0,i.Hp)(n.entityProps,l,u.prop,o),(0,i.Fr)(n.toolbarActions,d,a)}),(0,f.U)(()=>!0))}static#t=this.\u0275fac=function(o){return new(o||e)(t.LFG(t.zs3))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})()}}]);