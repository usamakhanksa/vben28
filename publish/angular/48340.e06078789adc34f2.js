"use strict";(self.webpackChunkfandaqapp=self.webpackChunkfandaqapp||[]).push([[48340],{48340:($t,$,m)=>{m.r($),m.d($,{ConnectionStringsComponent:()=>L,DEFAULT_EDITIONS_ENTITY_ACTIONS:()=>ue,DEFAULT_EDITIONS_ENTITY_PROPS:()=>_e,DEFAULT_EDITIONS_FORM_PROPS:()=>B,DEFAULT_EDITIONS_TOOLBAR_ACTIONS:()=>ge,DEFAULT_SAAS_CREATE_FORM_PROPS:()=>H,DEFAULT_SAAS_EDIT_FORM_PROPS:()=>K,DEFAULT_SAAS_ENTITY_ACTIONS:()=>j,DEFAULT_SAAS_ENTITY_PROPS:()=>W,DEFAULT_SAAS_TOOLBAR_ACTIONS:()=>G,DEFAULT_TENANTS_CREATE_FORM_PROPS:()=>D,DEFAULT_TENANTS_EDIT_FORM_PROPS:()=>fe,DEFAULT_TENANTS_ENTITY_ACTIONS:()=>he,DEFAULT_TENANTS_ENTITY_PROPS:()=>be,DEFAULT_TENANTS_TOOLBAR_ACTIONS:()=>Te,EditionDeleteComponent:()=>ce,EditionDeleteValidator:()=>le,EditionsComponent:()=>v,EditionsUsageWidgetComponent:()=>pe,ImpersonateTenantModalComponent:()=>Q,ImpersonateTenantModalService:()=>Y,LatestTenantsWidgetComponent:()=>me,MoveAllTenantsComponent:()=>de,SAAS_CREATE_FORM_PROP_CONTRIBUTORS:()=>q,SAAS_EDIT_FORM_PROP_CONTRIBUTORS:()=>J,SAAS_ENTITY_ACTION_CONTRIBUTORS:()=>I,SAAS_ENTITY_PROP_CONTRIBUTORS:()=>U,SAAS_TOOLBAR_ACTION_CONTRIBUTORS:()=>w,SaasExtensionsGuard:()=>jt,SaasModule:()=>Ht,SetTenantPasswordModalComponent:()=>z,TenantsComponent:()=>f,defaultDateFormatRegex:()=>Kt,saasExtensionsResolver:()=>ve});var X=m(49671),e=m(19212),u=m(96814),p=m(69670),l=m(88762);let y=(()=>{class n{constructor(t){this.restService=t,this.apiName="SaasHost",this.create=(i,a)=>this.restService.request({method:"POST",url:"/api/saas/editions",body:i},{apiName:this.apiName,...a}),this.delete=(i,a)=>this.restService.request({method:"DELETE",url:`/api/saas/editions/${i}`},{apiName:this.apiName,...a}),this.get=(i,a)=>this.restService.request({method:"GET",url:`/api/saas/editions/${i}`},{apiName:this.apiName,...a}),this.getAllList=i=>this.restService.request({method:"GET",url:"/api/saas/editions/all"},{apiName:this.apiName,...i}),this.getList=(i,a)=>this.restService.request({method:"GET",url:"/api/saas/editions",params:{filter:i.filter,sorting:i.sorting,skipCount:i.skipCount,maxResultCount:i.maxResultCount}},{apiName:this.apiName,...a}),this.getPlanLookup=i=>this.restService.request({method:"GET",url:"/api/saas/editions/plan-lookup"},{apiName:this.apiName,...i}),this.getUsageStatistics=i=>this.restService.request({method:"GET",url:"/api/saas/editions/statistics/usage-statistic"},{apiName:this.apiName,...i}),this.moveAllTenants=(i,a,r)=>this.restService.request({method:"PUT",url:`/api/saas/editions/${i}/move-all-tenants`,params:{editionId:a}},{apiName:this.apiName,...r}),this.update=(i,a,r)=>this.restService.request({method:"PUT",url:`/api/saas/editions/${i}`,body:a},{apiName:this.apiName,...r})}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(l.vgb))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),E=(()=>{class n{constructor(t){this.restService=t,this.apiName="SaasHost",this.applyDatabaseMigrations=(i,a)=>this.restService.request({method:"POST",url:`/api/saas/tenants/${i}/apply-database-migrations`},{apiName:this.apiName,...a}),this.checkConnectionString=(i,a)=>this.restService.request({method:"GET",url:"/api/saas/tenants/check-connection-string",params:{connectionString:i}},{apiName:this.apiName,...a}),this.create=(i,a)=>this.restService.request({method:"POST",url:"/api/saas/tenants",body:i},{apiName:this.apiName,...a}),this.delete=(i,a)=>this.restService.request({method:"DELETE",url:`/api/saas/tenants/${i}`},{apiName:this.apiName,...a}),this.get=(i,a)=>this.restService.request({method:"GET",url:`/api/saas/tenants/${i}`},{apiName:this.apiName,...a}),this.getConnectionStrings=(i,a)=>this.restService.request({method:"GET",url:`/api/saas/tenants/${i}/connection-strings`},{apiName:this.apiName,...a}),this.getDatabases=i=>this.restService.request({method:"GET",url:"/api/saas/tenants/databases"},{apiName:this.apiName,...i}),this.getEditionLookup=i=>this.restService.request({method:"GET",url:"/api/saas/tenants/lookup/editions"},{apiName:this.apiName,...i}),this.getList=(i,a)=>this.restService.request({method:"GET",url:"/api/saas/tenants",params:{filter:i.filter,getEditionNames:i.getEditionNames,editionId:i.editionId,expirationDateMin:i.expirationDateMin,expirationDateMax:i.expirationDateMax,activationState:i.activationState,sorting:i.sorting,skipCount:i.skipCount,maxResultCount:i.maxResultCount}},{apiName:this.apiName,...a}),this.setPassword=(i,a,r)=>this.restService.request({method:"PUT",url:`/api/saas/tenants/${i}/set-password`,body:a},{apiName:this.apiName,...r}),this.update=(i,a,r)=>this.restService.request({method:"PUT",url:`/api/saas/tenants/${i}`,body:a},{apiName:this.apiName,...r}),this.updateConnectionStrings=(i,a,r)=>this.restService.request({method:"PUT",url:`/api/saas/tenants/${i}/connection-strings`,body:a},{apiName:this.apiName,...r})}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(l.vgb))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var P=function(n){return n[n.Waiting=0]="Waiting",n[n.Completed=1]="Completed",n[n.Failed=2]="Failed",n[n.Refunded=3]="Refunded",n}(P||{});(0,l.Uoq)(P);var R=function(n){return n[n.OneTime=0]="OneTime",n[n.Subscription=1]="Subscription",n}(R||{});(0,l.Uoq)(R);var h=function(n){return n[n.Active=0]="Active",n[n.ActiveWithLimitedTime=1]="ActiveWithLimitedTime",n[n.Passive=2]="Passive",n}(h||{});const ye=(0,l.Uoq)(h);var A=m(64716),Ne=m(32181),x=m(99397),k=m(24036),ee=m(65619),N=m(22096),Z=m(37398),s=m(60095),te=m(71993),_=m(11411),c=m(17557),M=m(65765),b=m(86123),O=m(9517),g=m(32427),Ze=m(23079),F=m(74970),ne=m(23758);function Ee(n,o){1&n&&(e.TgZ(0,"h5",4),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"AbpUi::AreYouSure")," "))}function Me(n,o){if(1&n&&(e.TgZ(0,"option",19),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.displayName," ")}}const Oe=n=>({"border-danger":n});function Fe(n,o){if(1&n&&(e.TgZ(0,"select",16)(1,"option",17),e._uU(2),e.ALo(3,"abpLocalization"),e.qZA(),e.YNc(4,Me,2,2,"option",18),e.qZA()),2&n){const t=e.oxw(4);e.Q6J("ngClass",e.VKq(7,Oe,t.showAssignErrorMessage())),e.xp6(1),e.Q6J("ngValue",null),e.xp6(1),e.hij(" ",e.lcZ(3,5,t.loading()?"AbpUi::LoadingWithThreeDot":"Saas::SelectAnEditionToAssign")," "),e.xp6(2),e.Q6J("ngForOf",t.editions())("ngForTrackBy",t.trackByFn)}}function Le(n,o){1&n&&(e.TgZ(0,"span",20),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"AbpValidation::ThisFieldIsRequired.")," "))}function De(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",9),e._UZ(2,"input",12),e.TgZ(3,"label",13),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()(),e.YNc(6,Fe,5,9,"select",14),e.ALo(7,"async"),e.YNc(8,Le,3,3,"span",15),e.BQk()),2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("value",!0),e.xp6(2),e.Oqu(e.lcZ(5,4,"Saas::AssignTenantsToOtherEdition")),e.xp6(2),e.Q6J("ngIf",e.lcZ(7,6,t.assignType$)),e.xp6(2),e.Q6J("ngIf",t.showAssignErrorMessage())}}function Ie(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"p",8),e._uU(2),e.ALo(3,"abpLocalization"),e.qZA(),e.TgZ(4,"div",9),e._UZ(5,"input",10),e.TgZ(6,"label",11),e._uU(7),e.ALo(8,"abpLocalization"),e.qZA()(),e.YNc(9,De,9,8,"ng-container",7),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",e.xi3(3,4,"Saas::ChooseAnAction",t.tenantCount)," "),e.xp6(3),e.Q6J("value",!1),e.xp6(2),e.Oqu(e.lcZ(8,7,"Saas::UnassignTheEditionFromTheTenants")),e.xp6(2),e.Q6J("ngIf",t.editions().length>0)}}function we(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p",5),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"form",6),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.save())}),e.YNc(4,Ie,10,9,"ng-container",7),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,3,"Saas::EditionDeletionConfirmationMessage",t.name)," "),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.tenantCount>0)}}function Ue(n,o){if(1&n&&(e.TgZ(0,"button",21),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"button",22),e._UZ(4,"i",23),e._uU(5),e.ALo(6,"abpLocalization"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,3,"AbpUi::Cancel")," "),e.xp6(2),e.Q6J("loading",t.loading()),e.xp6(2),e.hij(" ",e.lcZ(6,5,"AbpUi::Delete")," ")}}function qe(n,o){1&n&&(e.TgZ(0,"h5",4),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Saas::MoveAllTenants")," "))}function Je(n,o){if(1&n&&(e.TgZ(0,"option",10),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.displayName)}}function Pe(n,o){if(1&n){const t=e.EpF();e._UZ(0,"p",5),e.ALo(1,"abpLocalization"),e.TgZ(2,"form",6),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.save())}),e.TgZ(3,"select",7)(4,"option",8),e._uU(5),e.ALo(6,"abpLocalization"),e.qZA(),e.YNc(7,Je,2,2,"option",9),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("innerHTML",e.xi3(1,5,"Saas::MoveAllTenantsWithEditionTo",t.name),e.oJD),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(3),e.Oqu(e.lcZ(6,8,t.loading()?"AbpUi::LoadingWithThreeDot":"Saas::UnassignEdition")),e.xp6(2),e.Q6J("ngForOf",t.editions())("ngForTrackBy",t.trackByFn)}}function Re(n,o){if(1&n&&(e.TgZ(0,"button",11),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"button",12),e._UZ(4,"i",13),e._uU(5),e.ALo(6,"abpLocalization"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,4,"AbpUi::Cancel")," "),e.xp6(2),e.Q6J("loading",t.loading())("disabled",t.form.invalid&&t.form.touched),e.xp6(2),e.hij(" ",e.lcZ(6,6,"AbpUi::Save")," ")}}function ke(n,o){if(1&n&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,null!=t.selected&&t.selected.id?"Saas::Edit":"Saas::NewEdition"))}}function Ve(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"form",12),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e.TgZ(1,"div",13),e._UZ(2,"abp-extensible-form",14),e.qZA()()}if(2&n){const t=e.oxw(2);e.Q6J("formGroup",t.editionForm),e.xp6(2),e.Q6J("selectedRecord",t.selected)}}function ze(n,o){if(1&n&&e.YNc(0,Ve,3,2,"form",11),2&n){const t=e.oxw();e.um2(0,t.editionForm?0:-1)}}function Ye(n,o){1&n&&(e.TgZ(0,"button",15),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"abp-button",16),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"Saas::Cancel")," "),e.xp6(3),e.Oqu(e.lcZ(5,4,"AbpIdentity::Save")))}function Qe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"abp-feature-management",17),e.NdJ("visibleChange",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.visibleFeatures=a)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("visible",t.visibleFeatures)("providerKey",t.providerKey)}}function Be(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"abp-edition-delete",18),e.NdJ("visibleChange",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.onVisibleDeleteChange(a))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("visible",t.visibleEditionDelete)("selected",t.selected)}}function je(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"abp-move-all-tenants",18),e.NdJ("visibleChange",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.onVisibleMoveChange(a))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("visible",t.visibleMove)("selected",t.selected)}}const Ge=()=>({value:"E"}),V=n=>({value:n}),ie=n=>({value:n,twoWay:!0}),ae=(n,o,t)=>({providerName:n,providerKey:o,visible:t}),oe=n=>({visibleChange:n}),se=(n,o)=>({inputs:n,outputs:o,componentKey:"FeatureManagement.FeatureManagementComponent"});function We(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",9)(1,"div",10)(2,"label",11),e._uU(3),e.ALo(4,"abpLocalization"),e.qZA(),e._UZ(5,"input",12),e.qZA(),e.TgZ(6,"div",13)(7,"button",14),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.checkConnectionString())}),e._uU(8),e.ALo(9,"abpLocalization"),e.qZA()()()}2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,2,"Saas::DisplayName:Default")),e.xp6(5),e.hij(" ",e.lcZ(9,4,"Saas::CheckConnectionString")," "))}function He(n,o){if(1&n&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("ngValue",t),e.xp6(1),e.hij(" ",t.databaseName," ")}}function Ke(n,o){if(1&n&&(e.ynx(0),e.YNc(1,He,2,2,"option",32),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",!t.connectionString)}}function $e(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"strong"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",38)(5,"button",39),e.NdJ("click",function(){e.CHM(t),e.oxw();const a=e.MAs(9);return e.KtG(a.close())}),e._uU(6),e.ALo(7,"abpLocalization"),e.qZA(),e.TgZ(8,"button",40),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).index,r=e.oxw(4);return e.KtG(r.removeDbConnectionString(a))}),e._uU(9),e.ALo(10,"abpLocalization"),e.qZA()()}2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,3,"AbpUi::AreYouSure")),e.xp6(5),e.hij(" ",e.lcZ(7,5,"AbpUi::Cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(10,7,"AbpUi::Yes")," "))}function Xe(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.YNc(6,$e,11,9,"ng-template",null,34,e.W1O),e.TgZ(8,"button",35,36),e._UZ(10,"i",37),e.qZA()()()),2&n){const t=e.MAs(7),i=e.oxw().$implicit;e.xp6(2),e.Oqu(i.databaseName),e.xp6(2),e.Oqu(i.connectionString),e.xp6(4),e.Q6J("ngbPopover",t)}}function et(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Xe,11,3,"tr",18),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t.connectionString)}}function tt(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",19)(2,"div",20)(3,"div",4)(4,"label",21),e._uU(5),e.ALo(6,"abpLocalization"),e.qZA(),e.TgZ(7,"select",22),e.NdJ("ngModelChange",function(a){e.CHM(t);const r=e.oxw(3);return e.KtG(r.selectedDatabase=a)}),e.YNc(8,Ke,2,1,"ng-container",23),e.qZA()()(),e.TgZ(9,"div",24)(10,"div",4)(11,"label",25),e._uU(12),e.ALo(13,"abpLocalization"),e.qZA(),e.TgZ(14,"input",26),e.NdJ("ngModelChange",function(a){e.CHM(t);const r=e.oxw(3);return e.KtG(r.databaseConnectionString=a)})("keyup.enter",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.addDatabaseConnectionString())}),e.qZA()()(),e.TgZ(15,"div",27)(16,"button",28),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.addDatabaseConnectionString())}),e._uU(17),e.ALo(18,"abpLocalization"),e.qZA(),e.TgZ(19,"button",29),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.checkConnectionString(a.databaseConnectionString))}),e._uU(20),e.ALo(21,"abpLocalization"),e.qZA()()(),e.TgZ(22,"div",30)(23,"table",31)(24,"thead")(25,"tr")(26,"th"),e._uU(27),e.ALo(28,"abpLocalization"),e.qZA(),e.TgZ(29,"th"),e._uU(30),e.ALo(31,"abpLocalization"),e.qZA(),e.TgZ(32,"th"),e._uU(33),e.ALo(34,"abpLocalization"),e.qZA()()(),e.TgZ(35,"tbody"),e.YNc(36,et,2,1,"ng-container",23),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw(3);e.xp6(5),e.Oqu(e.lcZ(6,11,"Saas::DisplayName:DatabaseName")),e.xp6(2),e.Q6J("ngModel",t.selectedDatabase),e.xp6(1),e.Q6J("ngForOf",t.databases),e.xp6(4),e.Oqu(e.lcZ(13,13,"Saas::DisplayName:ConnectionString")),e.xp6(2),e.Q6J("ngModel",t.databaseConnectionString),e.xp6(3),e.hij(" ",e.lcZ(18,15,"Saas::AddDatabaseConnectionString")," "),e.xp6(3),e.hij(" ",e.lcZ(21,17,"Saas::CheckConnectionString")," "),e.xp6(7),e.Oqu(e.lcZ(28,19,"Saas::DisplayName:DatabaseName")),e.xp6(3),e.Oqu(e.lcZ(31,21,"Saas::DisplayName:ConnectionString")),e.xp6(3),e.Oqu(e.lcZ(34,23,"Saas::Actions")),e.xp6(3),e.Q6J("ngForOf",t.databases)}}function nt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",15)(1,"input",16),e.NdJ("ngModelChange",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.moduleSpecificDatabase=a)}),e.qZA(),e.TgZ(2,"label",17),e._uU(3),e.ALo(4,"abpLocalization"),e.qZA()(),e.YNc(5,tt,37,25,"ng-container",18)}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.moduleSpecificDatabase),e.xp6(2),e.hij(" ",e.lcZ(4,3,"Saas::DisplayName:UseSpecificDatabase")," "),e.xp6(2),e.Q6J("ngIf",(null==t.databases?null:t.databases.length)&&t.moduleSpecificDatabase)}}function it(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"form",3),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formSubmit.emit())}),e.TgZ(2,"div",4)(3,"div",5)(4,"input",6),e.NdJ("ngModelChange",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onSharedDatabaseChange())}),e.qZA(),e.TgZ(5,"label",7),e._uU(6),e.ALo(7,"abpLocalization"),e.qZA()()(),e.YNc(8,We,10,6,"div",8),e.qZA(),e.YNc(9,nt,6,5),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(5),e.Oqu(e.lcZ(7,4,"Saas::DisplayName:UseSharedDatabase")),e.xp6(2),e.Q6J("ngIf",!t.form.get("useSharedDatabase").value),e.xp6(1),e.um2(9,!t.form.get("useSharedDatabase").value&&null!=t.databases&&t.databases.length?9:-1)}}function at(n,o){1&n&&(e.TgZ(0,"div",41),e._UZ(1,"i",42),e.qZA())}function ot(n,o){if(1&n&&(e.TgZ(0,"h5"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.AsE("",e.lcZ(2,2,"AbpIdentity::SetPassword")," - ",t.tenantName,"")}}function st(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"form",5,6),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.MAs(1),r=e.oxw(2);return e.KtG(r.save(a))}),e.TgZ(2,"div",7)(3,"label",8),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA(),e._UZ(6,"input",9),e.ALo(7,"abpLocalization"),e.qZA(),e.TgZ(8,"div",7)(9,"label",10),e._uU(10),e.ALo(11,"abpLocalization"),e.qZA(),e.TgZ(12,"div",11),e._UZ(13,"input",12),e.TgZ(14,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.fieldTextType=!a.fieldTextType)}),e._UZ(15,"i"),e.qZA(),e.TgZ(16,"button",14),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.generatePassword())}),e.ALo(17,"abpLocalization"),e._UZ(18,"i",15),e.qZA()()()()}if(2&n){const t=e.oxw(2);e.Q6J("formGroup",t.form)("markAsDirtyWhenSubmit",!1),e.xp6(4),e.Oqu(e.lcZ(5,10,"Saas::UserName")),e.xp6(2),e.s9C("ngbTooltip",e.lcZ(7,12,"Saas::UserNameTooltip")),e.xp6(4),e.Oqu(e.lcZ(11,14,"Saas::Password")),e.xp6(3),e.Q6J("type",t.fieldTextType?"text":"password"),e.xp6(2),e.Gre("fa fa-eye",t.fieldTextType?"":"-slash",""),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(17,16,"AbpIdentity::GenerateRandomPasswordTooltip"))}}function rt(n,o){if(1&n&&e.YNc(0,st,19,18,"form",4),2&n){const t=e.oxw();e.Q6J("ngIf",t.form)}}function lt(n,o){1&n&&(e.TgZ(0,"button",16),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"abp-button",17),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"Saas::Cancel")," "),e.xp6(3),e.Oqu(e.lcZ(5,4,"Saas::Save")))}const ct=()=>({size:"md"});function dt(n,o){1&n&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Saas::LoginWithThisTenant")))}function pt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"form",5),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e.TgZ(1,"div",6)(2,"label",7),e._uU(3),e.ALo(4,"abpLocalization"),e.qZA(),e._UZ(5,"input",8),e.qZA()()}if(2&n){const t=e.oxw(2);e.Q6J("formGroup",t.form),e.xp6(3),e.hij(" ",e.lcZ(4,2,"Saas::UserName")," ")}}function mt(n,o){if(1&n&&e.YNc(0,pt,6,4,"form",4),2&n){const t=e.oxw();e.Q6J("ngIf",t.form)}}function ut(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.visibleChange(!1))}),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"button",10),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()}2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"Saas::Cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(5,4,"Saas::Login")," "))}const _t=["tenantModalTemplate"],gt=["connectionStringModalTemplate"];function ht(n,o){if(1&n&&(e.TgZ(0,"option",15),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&n){const t=o.$implicit;e.Q6J("ngValue",t.key),e.xp6(1),e.hij(" ",e.lcZ(2,2,"Saas::Enum:TenantActivationState."+t.key)," ")}}function bt(n,o){if(1&n&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.selectedModalContent.title))}}function ft(n,o){1&n&&e.GkF(0)}function Tt(n,o){if(1&n&&e.YNc(0,ft,1,0,"ng-container",31),2&n){const t=e.oxw();e.Q6J("ngTemplateOutlet",null==t.selectedModalContent?null:t.selectedModalContent.template)}}function vt(n,o){1&n&&(e.TgZ(0,"abp-button",36),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"AbpIdentity::Save")))}function St(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"abp-button",37),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.isDisabledSaveButton),e.xp6(1),e.Oqu(e.lcZ(2,2,"AbpIdentity::Save"))}}function Ct(n,o){if(1&n&&(e.TgZ(0,"button",32),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.ynx(3,33),e.YNc(4,vt,3,3,"abp-button",34)(5,St,3,4,"abp-button",35),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,4,"Saas::Cancel")," "),e.xp6(2),e.Q6J("ngSwitch",null==t.selectedModalContent?null:t.selectedModalContent.type),e.xp6(1),e.Q6J("ngSwitchCase","saveTenant"),e.xp6(1),e.Q6J("ngSwitchCase","saveConnStr")}}function At(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"abp-set-tenant-password-modal",39),e.NdJ("modalVisibleChange",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.closeSetTenantPasswordModal())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("modalVisible",t.isVisibleSetTenantPasswordModal)("tenantId",t.selectedTenantId)("tenantName",t.selectedTenantNameForSetTenantPasswordModal)}}function xt(n,o){if(1&n&&(e.ynx(0),e.YNc(1,At,1,3,"abp-set-tenant-password-modal",38),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("abpReplaceableTemplate",t.setTenantReplaceableTemplateOptions)}}function yt(n,o){1&n&&e.GkF(0)}function Nt(n,o){1&n&&e.GkF(0)}function Zt(n,o){if(1&n&&e.YNc(0,Nt,1,0,"ng-container",31),2&n){e.oxw(2);const t=e.MAs(4);e.Q6J("ngTemplateOutlet",t)}}function Et(n,o){1&n&&e.GkF(0)}function Mt(n,o){if(1&n&&e.YNc(0,Et,1,0,"ng-container",31),2&n){e.oxw(2);const t=e.MAs(6);e.Q6J("ngTemplateOutlet",t)}}function Ot(n,o){if(1&n&&(e.TgZ(0,"ul",43,44)(2,"li",45)(3,"a",46),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA(),e.YNc(6,Zt,1,1,"ng-template",47),e.qZA(),e.TgZ(7,"li",45)(8,"a",46),e._uU(9),e.ALo(10,"abpLocalization"),e.qZA(),e.YNc(11,Mt,1,1,"ng-template",47),e.qZA()(),e._UZ(12,"div",48)),2&n){const t=e.MAs(1);e.Q6J("destroyOnHide",!1),e.xp6(4),e.Oqu(e.lcZ(5,4,"Saas::TenantBaseInfo")),e.xp6(5),e.Oqu(e.lcZ(10,6,"Saas::ConnectionStrings")),e.xp6(3),e.Q6J("ngbNavOutlet",t)}}function Ft(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"form",50),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.save())}),e._UZ(1,"abp-extensible-form",51),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("formGroup",t.tenantForm),e.xp6(1),e.Q6J("selectedRecord",t.selected)}}function Lt(n,o){if(1&n&&e.YNc(0,Ft,2,2,"form",49),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.tenantForm)}}function Dt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"abp-connection-strings",53),e.NdJ("formSubmit",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.save())}),e.qZA()}}const re=n=>({formSubmit:n}),It=(n,o)=>({outputs:n,componentKey:o});function wt(n,o){if(1&n&&e.YNc(0,Dt,1,0,"abp-connection-strings",52),2&n){const t=e.oxw(2);e.Q6J("abpReplaceableTemplate",e.WLB(3,It,e.VKq(1,re,t.save),t.connectionStringsReplacementKey))}}function Ut(n,o){if(1&n&&e.YNc(0,yt,1,0,"ng-container",31)(1,Ot,13,8,"ng-template",null,40,e.W1O)(3,Lt,1,1,"ng-template",null,41,e.W1O)(5,wt,1,6,"ng-template",null,42,e.W1O),2&n){const t=e.MAs(2),i=e.MAs(4),a=e.oxw();e.Q6J("ngTemplateOutlet",null!=a.selected&&a.selected.id?i:t)}}function qt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"abp-connection-strings",55),e.NdJ("formSubmit",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("selectedTenant",t.selected)}}const Jt=n=>({selectedTenant:n}),Pt=(n,o,t)=>({inputs:n,outputs:o,componentKey:t});function Rt(n,o){if(1&n&&e.YNc(0,qt,1,1,"abp-connection-strings",54),2&n){const t=e.oxw();e.Q6J("abpReplaceableTemplate",e.kEZ(7,Pt,e.VKq(3,Jt,e.VKq(1,V,t.selected)),e.VKq(5,re,t.save),t.connectionStringsReplacementKey))}}function kt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"abp-feature-management",56),e.NdJ("visibleChange",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.visibleFeatures=a)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("visible",t.visibleFeatures)("providerKey",t.providerKey)}}const Vt=()=>({size:"lg"}),zt=()=>({value:"T"});function Yt(n,o){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"h5",4),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6),e._UZ(8,"abp-chart",7,8),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,4,"Saas::EditionUsageStatistics")),e.xp6(4),e.Q6J("data",t.chartData)("width",t.width)("height",t.height)}}function Qt(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"th"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA()()),2&n){const t=o.$implicit,i=o.index;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.editionName)}}function Bt(n,o){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"h5",4),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()(),e.TgZ(6,"div",5)(7,"div")(8,"table",6)(9,"thead")(10,"tr")(11,"th"),e._uU(12,"#"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"abpLocalization"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"abpLocalization"),e.qZA()()(),e.TgZ(19,"tbody"),e.YNc(20,Qt,7,3,"tr",7),e.qZA()()()()()()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,7,"Saas::LatestTenants")),e.xp6(3),e.Udp("min-height",t.minHeight,"px"),e.xp6(7),e.Oqu(e.lcZ(15,9,"Saas::Name")),e.xp6(3),e.Oqu(e.lcZ(18,11,"Saas::EditionName")),e.xp6(3),e.Q6J("ngForOf",t.data)("ngForTrackBy",t.trackByFn)}}function le(){return n=>{const o=n.get("assignType")?.value,t=n.get("edition")?.value;return!o||o&&t?null:{edition:{required:!0}}}}let ce=(()=>{class n{constructor(){this.visibleChange=new e.vpe,this.#e=(0,e.tdS)(!1),this.loading=(0,e.tdS)(!1),this.#t=(0,e.tdS)([]),this.editions=(0,e.Flj)(()=>this.#t().filter(t=>!this.selected||t.id!==this.selected?.id)),this.trackByService=(0,e.f3M)(l.vR3),this.trackByFn=this.trackByService.by("id"),this.editionService=(0,e.f3M)(y),this.fb=(0,e.f3M)(s.qu),this.destroyRef=(0,e.f3M)(e.ktI),this.form=this.fb.group({assignType:[!1],edition:[null]},{validators:n=>{const o=n.get("assignType")?.value,t=n.get("edition")?.value;return!o||o&&t?null:{edition:{required:!0}}}})}#e;#t;get tenantCount(){return this.selected?.tenantCount||0}get name(){return this.selected?.displayName||""}get assignType$(){return this.form.controls.assignType.valueChanges}get assignType(){return this.form.controls.assignType}get edition(){return this.form.controls.edition}onVisibleChange(t){this.visibleChange.emit({visible:t,refresh:!1})}ngOnInit(){this.loading.set(!0),this.editionService.getAllList().pipe((0,A.x)(()=>this.loading.set(!1))).subscribe(t=>this.#t.set(t)),this.assignType$.pipe((0,Ne.h)(t=>!t),(0,x.b)(()=>this.#e.set(!1)),(0,te.sL)(this.destroyRef)).subscribe()}showAssignErrorMessage(){return this.assignType.value&&!this.edition.value&&this.form.errors.edition.required&&this.#e()}save(){var t=this;return(0,X.Z)(function*(){if(t.#e.set(!0),t.form.invalid)return;t.loading.set(!0);const{assignType:i,edition:a}=t.form.value;if(i){const d=t.editionService.moveAllTenants(t.selected.id,a);yield(0,k.z)(d)}const r=t.editionService.delete(t.selected.id);yield(0,k.z)(r),t.loading.set(!1),t.visibleChange.emit({visible:!1,refresh:!0})})()}static#n=this.\u0275fac=function(i){return new(i||n)};static#i=this.\u0275cmp=e.Xpm({type:n,selectors:[["abp-edition-delete"]],inputs:{visible:"visible",selected:"selected"},outputs:{visibleChange:"visibleChange"},standalone:!0,features:[e.jDz],decls:7,vars:2,consts:[[3,"visible","suppressUnsavedChangesWarning","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[1,"modal-title"],[1,"fw-bold"],["id","edition-delete-form",3,"formGroup","ngSubmit"],[4,"ngIf"],[1,"mt-2"],[1,"form-check","mt-2"],["formControlName","assignType","type","radio","name","assignType","id","unassign",1,"form-check-input",3,"value"],["for","unassign",1,"form-check-label"],["formControlName","assignType","type","radio","name","assignType","id","assign",1,"form-check-input",3,"value"],["for","assign",1,"form-check-label"],["class","form-select mt-2","formControlName","edition",3,"ngClass",4,"ngIf"],["class","text-danger",4,"ngIf"],["formControlName","edition",1,"form-select","mt-2",3,"ngClass"],["selected","",3,"ngValue"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[3,"value"],[1,"text-danger"],["abpClose","","type","button",1,"btn","btn-secondary"],["type","submit","form","edition-delete-form",1,"btn","btn-primary",3,"loading"],["aria-hidden","true",1,"fa","fa-trash"]],template:function(i,a){1&i&&(e.TgZ(0,"abp-modal",0),e.NdJ("visibleChange",function(d){return a.onVisibleChange(d)}),e.YNc(1,Ee,3,3,"ng-template",null,1,e.W1O)(3,we,5,6,"ng-template",null,2,e.W1O)(5,Ue,7,7,"ng-template",null,3,e.W1O),e.qZA()),2&i&&e.Q6J("visible",a.visible)("suppressUnsavedChangesWarning",!0)},dependencies:[u.ez,u.mk,u.sg,u.O5,u.Ov,p.e2,_.hL,_.J5,p.zS,p.YM,l.IR2,s._Y,s.YN,s.Kr,s.Fj,s.EJ,s._,s.JJ,s.JL,s.sg,s.u,l.fuE,l.YzZ],encapsulation:2})}return n})(),de=(()=>{class n{constructor(){this.visibleChange=new e.vpe,this.loading=(0,e.tdS)(!1),this.#e=(0,e.tdS)([]),this.editions=(0,e.Flj)(()=>this.#e().filter(t=>!this.selected||t.id!==this.selected?.id)),this.trackByService=(0,e.f3M)(l.vR3),this.trackByFn=this.trackByService.by("id"),this.editionService=(0,e.f3M)(y),this.fb=(0,e.f3M)(s.qu),this.form=this.fb.group({edition:[""]})}#e;get name(){return this.selected?.displayName||""}onVisibleChange(t){this.visibleChange.emit({visible:t,refresh:!1})}ngOnInit(){this.loading.set(!0),this.editionService.getAllList().pipe((0,A.x)(()=>this.loading.set(!1))).subscribe(t=>this.#e.set(t))}save(){var t=this;return(0,X.Z)(function*(){if(t.form.invalid)return;t.loading.set(!0);const{edition:i}=t.form.value,a=t.editionService.moveAllTenants(t.selected.id,i);yield(0,k.z)(a),t.loading.set(!1),t.visibleChange.emit({visible:!1,refresh:!0})})()}static#t=this.\u0275fac=function(i){return new(i||n)};static#n=this.\u0275cmp=e.Xpm({type:n,selectors:[["abp-move-all-tenants"]],inputs:{visible:"visible",selected:"selected"},outputs:{visibleChange:"visibleChange"},standalone:!0,features:[e.jDz],decls:7,vars:2,consts:[[3,"visible","suppressUnsavedChangesWarning","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[1,"modal-title"],[3,"innerHTML"],["id","edition-move-tenants-form",3,"formGroup","ngSubmit"],["formControlName","edition",1,"form-select","mt-2"],["value","","selected",""],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[3,"value"],["abpClose","","type","button",1,"btn","btn-secondary"],["type","submit","form","edition-move-tenants-form",1,"btn","btn-primary",3,"loading","disabled"],["aria-hidden","true",1,"fa","fa-check","me-1"]],template:function(i,a){1&i&&(e.TgZ(0,"abp-modal",0),e.NdJ("visibleChange",function(d){return a.onVisibleChange(d)}),e.YNc(1,qe,3,3,"ng-template",null,1,e.W1O)(3,Pe,8,10,"ng-template",null,2,e.W1O)(5,Re,7,8,"ng-template",null,3,e.W1O),e.qZA()),2&i&&e.Q6J("visible",a.visible)("suppressUnsavedChangesWarning",!0)},dependencies:[u.ez,u.sg,p.e2,_.hL,_.J5,p.zS,p.YM,l.IR2,s._Y,s.YN,s.Kr,s.EJ,s.JJ,s.JL,s.sg,s.u,l.fuE,l.YzZ],encapsulation:2})}return n})(),v=(()=>{class n{constructor(t,i,a,r,d){this.list=t,this.service=i,this.injector=a,this.confirmationService=r,this.destroyRef=d,this.data={items:[],totalCount:0},this.plans$=new ee.X([]),this.visibleMove=!1,this.isModalVisible=!1,this.visibleEditionDelete=!1,this.visibleFeatures=!1,this.modalBusy=!1,this.onVisibleFeaturesChange=S=>{this.visibleFeatures=S}}ngOnInit(){this.hookToQuery()}hookToQuery(){this.list.hookToQuery(t=>this.service.getList(t)).subscribe(t=>this.data=t)}createEditionForm(){this.getPlanLookup(()=>{const t=new c.lg(this.injector,this.selected);this.editionForm=(0,c.se)(t)})}onAddEdition(){this.selected={},this.createEditionForm(),this.isModalVisible=!0}onEditEdition(t){this.service.get(t).subscribe(i=>{this.selected=i,this.createEditionForm(),this.isModalVisible=!0})}save(){if(!this.editionForm.valid)return;this.modalBusy=!0;const{id:t}=this.selected;(t?this.service.update(t,{...this.selected,...this.editionForm.value}):this.service.create(this.editionForm.value)).pipe((0,A.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.list.get(),this.isModalVisible=!1})}openFeaturesModal(t){this.providerKey=t,setTimeout(()=>{this.visibleFeatures=!0},0)}getPlanLookup(t){this.service.getPlanLookup().subscribe(i=>{this.plans$.next(i),t()})}delete(t){this.selected=t,this.visibleEditionDelete=!0}onVisibleDeleteChange(t){t.visible||(t.refresh&&this.list.get(),this.selected=null,this.visibleEditionDelete=!1)}moveAllTenants(t){0!==t.tenantCount?(this.selected=t,this.visibleMove=!0):this.confirmationService.warn("Saas::ThereIsNoTenantsCurrentlyInThisEdition","AbpUi::Warning",{hideCancelBtn:!0,yesText:"AbpUi::Ok"}).pipe((0,te.sL)(this.destroyRef)).subscribe()}onVisibleMoveChange(t){t.visible||(t.refresh&&this.list.get(),this.selected=null,this.visibleMove=!1)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(l.XNV),e.Y36(y),e.Y36(e.zs3),e.Y36(p.YP),e.Y36(e.ktI))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["abp-editions"]],standalone:!0,features:[e._Bn([l.XNV,{provide:c.ex,useValue:"Saas.EditionsComponent"}]),e.jDz],decls:16,vars:27,consts:[[3,"title","toolbar"],["id","wrapper"],["localizationSourceName","Saas",3,"list"],[1,"card"],[3,"data","recordsTotal","list"],[3,"visible","busy","visibleChange","disappear"],["abpHeader",""],["abpBody",""],["abpFooter",""],["providerName","E",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[3,"visible","selected"],["id","editionForm","validateOnSubmit","",3,"formGroup"],["id","editionForm","validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"mt-2"],[3,"selectedRecord"],["abpClose","","type","button",1,"btn","btn-secondary"],["iconClass","fa fa-check","buttonType","submit","formName","editionForm"],["providerName","E",3,"visible","providerKey","visibleChange"],[3,"visible","selected","visibleChange"]],template:function(i,a){1&i&&(e.TgZ(0,"abp-page",0),e.ALo(1,"abpLocalization"),e.TgZ(2,"div",1),e._UZ(3,"abp-advanced-entity-filters",2),e.TgZ(4,"div",3),e._UZ(5,"abp-extensible-table",4),e.qZA()()(),e.TgZ(6,"abp-modal",5),e.NdJ("visibleChange",function(d){return a.isModalVisible=d})("disappear",function(){return a.createEditionForm()}),e.YNc(7,ke,3,3,"ng-template",null,6,e.W1O)(9,ze,1,1,"ng-template",null,7,e.W1O)(11,Ye,6,6,"ng-template",null,8,e.W1O),e.qZA(),e.YNc(13,Qe,1,2,"abp-feature-management",9)(14,Be,1,2,"abp-edition-delete",10)(15,je,1,2,"abp-move-all-tenants",10)),2&i&&(e.Q6J("title",e.lcZ(1,11,"Saas::Editions"))("toolbar",a.data.items),e.xp6(3),e.Q6J("list",a.list),e.xp6(2),e.Q6J("data",a.data.items)("recordsTotal",a.data.totalCount)("list",a.list),e.xp6(1),e.Q6J("visible",a.isModalVisible)("busy",a.modalBusy),e.xp6(7),e.Q6J("abpReplaceableTemplate",e.WLB(24,se,e.kEZ(18,ae,e.DdM(13,Ge),e.VKq(14,V,a.providerKey),e.VKq(16,ie,a.visibleFeatures)),e.VKq(22,oe,a.onVisibleFeaturesChange))),e.xp6(1),e.um2(14,a.visibleEditionDelete?14:-1),e.xp6(1),e.um2(15,a.visibleMove?15:-1))},dependencies:[ce,de,_.h2,_.hL,M.BG,M.II,p.e2,p.r0,p.zS,p.YM,b.jE,b.hE,O.XE,O.$,c.hi,c.gt,c.m5,l.zLP,l.vaR,l.fuE,s.UX,s._Y,s.JL,s.sg],encapsulation:2})}return n})(),L=(()=>{class n{constructor(){this.formSubmit=new e.vpe,this.service=(0,e.f3M)(E),this.fb=(0,e.f3M)(s.QS),this.toasterService=(0,e.f3M)(p.MJ),this.form=this.fb.group({useSharedDatabase:[!0],defaultConnectionString:[null]}),this.moduleSpecificDatabase=!1}get useSharedDatabase(){return this.form.get("useSharedDatabase")}get defaultConnectionString(){return this.form.get("defaultConnectionString")}ngOnInit(){this.getInitialData()}getInitialData(){this.loading=!0,(this.selectedTenant?this.getConnectionStrings():this.getDatabases()).pipe((0,A.x)(()=>this.loading=!1)).subscribe()}selectFirstDatabase(){this.selectedDatabase=this.databases?.find(t=>!t.connectionString)}getDatabases(){return this.service.getDatabases().pipe((0,x.b)(t=>{this.databases=(t.databases||[]).map(i=>({id:"",databaseName:i,connectionString:null,extraProperties:null})),this.selectFirstDatabase()}))}getConnectionStrings(){return this.service.getConnectionStrings(this.selectedTenant.id).pipe((0,x.b)(t=>{this.form.setValue({useSharedDatabase:!t.default&&!t.databases.some(i=>!!i.connectionString),defaultConnectionString:t.default}),this.databases=t.databases,this.moduleSpecificDatabase=!1,this.databases.find(i=>{i.connectionString&&(this.moduleSpecificDatabase=!0)}),this.selectFirstDatabase()}))}onSharedDatabaseChange(){this.defaultConnectionString.setValue(null),this.defaultConnectionString.updateValueAndValidity()}addDatabaseConnectionString(){if(!this.databaseConnectionString)return;const t=this.databases.findIndex(i=>i.databaseName===this.selectedDatabase.databaseName);this.databases[t].connectionString=this.databaseConnectionString,this.databaseConnectionString=null,this.selectFirstDatabase()}removeDbConnectionString(t){this.databases[t].connectionString=null}getInput(){return this.useSharedDatabase.value?{extraProperties:void 0,id:"",default:null,databases:[]}:{extraProperties:void 0,id:"",default:this.defaultConnectionString.value,databases:this.databases.filter(t=>t.connectionString)}}checkConnectionString(t){this.service.checkConnectionString(t||this.defaultConnectionString.value).subscribe(i=>{if(i)return this.toasterService.success("Saas::ValidConnectionString");this.toasterService.error("Saas::InvalidConnectionString")})}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["abp-connection-strings"]],inputs:{selectedTenant:"selectedTenant"},outputs:{formSubmit:"formSubmit"},decls:4,vars:2,consts:[[1,"mt-2"],[4,"ngIf","ngIfElse"],["loadingTmp",""],[3,"formGroup","ngSubmit"],[1,"mb-3"],[1,"form-check","mb-2"],["id","useSharedDatabase","type","checkbox","formControlName","useSharedDatabase","autofocus","",1,"form-check-input",3,"ngModelChange"],["for","useSharedDatabase",1,"form-check-label"],["class","row mb-3",4,"ngIf"],[1,"row","mb-3"],[1,"col-md-8"],["for","defaultConnectionString",1,"form-label"],["type","text","id","defaultConnectionString","formControlName","defaultConnectionString",1,"form-control"],[1,"pt-3","col-md-2"],[1,"btn","btn-primary",3,"click"],[1,"mb-2","form-check"],["id","moduleSpecificDatabase","type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],["for","moduleSpecificDatabase",1,"form-check-label"],[4,"ngIf"],[1,"row"],[1,"mb-3","col-md-3"],["for","database-name",1,"form-label"],["id","database-name","name","database-name",1,"form-select","form-control",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"mb-3","col-md-6"],["for","connection-string",1,"form-label"],["type","text","id","connection-string","name","connection-string",1,"form-control",3,"ngModel","ngModelChange","keyup.enter"],[1,"mb-3","col-md-3","mt-3"],["type","button",1,"btn","btn-primary","me-1",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"form-row"],[1,"table"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],["popContent",""],["placement","left",1,"btn","btn-sm","btn-danger",3,"ngbPopover"],["popover","ngbPopover"],["aria-hidden","true",1,"fas","fa-trash"],[1,"text-end"],[1,"btn","btn-sm","btn-light","me-1",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"text-center"],["aria-hidden","true",1,"fas","fa-spinner","fa-spin","fa-lg"]],template:function(i,a){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,it,10,6,"ng-container",1)(2,at,2,0,"ng-template",null,2,e.W1O),e.qZA()),2&i){const r=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!a.loading)("ngIfElse",r)}},dependencies:[_.hL,_.J5,u.sg,u.O5,s._Y,s.YN,s.Kr,s.Fj,s.Wl,s.EJ,s.JJ,s.JL,s.On,s.sg,s.u,l.Uqp,l.YzZ,g.o8,l.fuE],encapsulation:2})}return n})(),z=(()=>{class n{constructor(t,i,a){this.fb=t,this.tenantService=i,this.toaster=a,this.modalVisible=!1,this.tenantId="",this.modalVisibleChange=new e.vpe,this.fieldTextType=!1}buildForm(){this.form=this.fb.group({adminName:["admin",[s.Validators.required]],password:["",[s.Validators.required]]})}save(t){if(this.form.invalid)return;const{adminName:i,password:a}=this.form.value;this.modalBusy=!0,this.tenantService.setPassword(this.tenantId,{username:i,password:a}).subscribe(()=>{this.toaster.success("AbpIdentity::PasswordChangedMessage"),t.resetForm(),this.modalVisibleChange.emit()}).add(()=>this.modalBusy=!1)}onModalVisibleChange(t){t||this.modalVisibleChange.emit()}ngOnChanges({modalVisible:t}){t&&t.currentValue&&this.buildForm()}generatePassword(){const t=(0,l.F2m)();this.form.controls.password.setValue(t)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(s.qu),e.Y36(E),e.Y36(p.MJ))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["abp-set-tenant-password-modal"]],inputs:{modalVisible:"modalVisible",tenantName:"tenantName",tenantId:"tenantId"},outputs:{modalVisibleChange:"modalVisibleChange"},features:[e.TTD],decls:7,vars:4,consts:[[3,"visible","busy","options","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],["id","setPasswordForm","validateOnSubmit","",3,"formGroup","markAsDirtyWhenSubmit","ngSubmit",4,"ngIf"],["id","setPasswordForm","validateOnSubmit","",3,"formGroup","markAsDirtyWhenSubmit","ngSubmit"],["ngForm","ngForm"],[1,"mb-3"],["for","adminName",1,"form-label"],["type","text","id","adminName","name","adminName","formControlName","adminName",1,"form-control",3,"ngbTooltip"],["for","password",1,"form-label"],["validationStyle","","validationTarget","",1,"input-group"],["id","password","name","password","formControlName","password","autofocus","",1,"form-control","flex-fill",3,"type"],["type","button",1,"btn","btn-secondary",3,"click"],["id","generate-random-password-button","type","button",1,"btn","btn-primary",3,"ngbTooltip","click"],["aria-hidden","true",1,"fa","fa-refresh"],["type","button","abpClose","",1,"btn","btn-secondary"],["iconClass","fa fa-check","buttonType","submit","formName","setPasswordForm"]],template:function(i,a){1&i&&(e.TgZ(0,"abp-modal",0),e.NdJ("visibleChange",function(d){return a.modalVisible=d})("visibleChange",function(d){return a.onModalVisibleChange(d)}),e.YNc(1,ot,3,4,"ng-template",null,1,e.W1O)(3,rt,1,1,"ng-template",null,2,e.W1O)(5,lt,6,6,"ng-template",null,3,e.W1O),e.qZA()),2&i&&e.Q6J("visible",a.modalVisible)("busy",a.modalBusy)("options",e.DdM(3,ct))},dependencies:[_.hL,_.Wh,_.kG,_.J5,u.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,l.Uqp,l.YzZ,p.r0,p.zS,p.YM,g._L,l.fuE],encapsulation:2})}return n})(),Y=(()=>{class n{constructor(){this.store=new l.gSB({tenantId:null,isVisible:void 0}),this.isVisible$=this.store.sliceState(t=>t.isVisible)}get tenantId(){return this.store.state.tenantId}setTenantId(t){this.store.patch({tenantId:t})}setValue(t){this.store.patch({isVisible:t})}hide(){this.setValue(!1),this.setTenantId(null)}show(t){this.setValue(!0),this.setTenantId(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Q=(()=>{class n{get isVisible$(){return this.service.isVisible$}constructor(){this.service=(0,e.f3M)(Y),this.fb=(0,e.f3M)(s.qu),this.impersonationService=(0,e.f3M)(Ze.hY),this.subscription=(0,e.f3M)(l.FFO),this.confirmation=(0,e.f3M)(p.YP),this.defaultTenantUserName="admin",this.buildForm()}success(){this.reset()}reset(){this.service.hide(),this.form.reset({tenantUserName:this.defaultTenantUserName})}buildForm(){this.form=this.fb.group({tenantUserName:[this.defaultTenantUserName,[s.Validators.required]]})}error(t){this.subscription.addOne(this.confirmation.error(t.error.error_description,t.error.error,{hideCancelBtn:!0,yesText:"AbpUi::Ok"})),console.error(t.error)}visibleChange(t){void 0===t||t||(this.service.setValue(t),this.reset())}save(){if(this.form.invalid)return;const a=this.impersonationService.impersonateTenant(this.service.tenantId,this.form.value.tenantUserName);this.subscription.addOne(a,()=>this.success(),r=>{this.error(r)})}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["abp-impersonate-tenant-modal"]],features:[e._Bn([l.FFO])],decls:8,vars:3,consts:[[3,"visible","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],["id","impersonateTenantForm",3,"formGroup","ngSubmit",4,"ngIf"],["id","impersonateTenantForm",3,"formGroup","ngSubmit"],[1,"mb-3"],["for","tenantUserName",1,"form-label"],["type","text","name","tenantUserName","id","tenantUserName","formControlName","tenantUserName",1,"form-control"],["type","button",1,"btn","btn-secondary",3,"click"],["form","impersonateTenantForm","type","submit",1,"btn","btn-primary"]],template:function(i,a){1&i&&(e.TgZ(0,"abp-modal",0),e.NdJ("visibleChange",function(d){return a.visibleChange(d)}),e.ALo(1,"async"),e.YNc(2,dt,3,3,"ng-template",null,1,e.W1O)(4,mt,1,1,"ng-template",null,2,e.W1O)(6,ut,6,6,"ng-template",null,3,e.W1O),e.qZA()),2&i&&e.Q6J("visible",e.lcZ(1,1,a.isVisible$))},dependencies:[_.hL,_.J5,u.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,l.YzZ,p.zS,u.Ov,l.fuE],encapsulation:2})}return n})(),f=(()=>{class n{get hasSelectedTenant(){return!!this.selected.id}get isDisabledSaveButton(){if(!this.selectedModalContent)return!1;const{type:t}=this.selectedModalContent,i=this.connectionStringsRef?.form.invalid;return!("saveConnStr"!==t||!i)||"saveTenant"===t&&this.tenantForm&&this.tenantForm.invalid}constructor(t,i,a,r,d,S,T){this.list=t,this.confirmationService=i,this.service=a,this.fb=r,this.injector=d,this.toaster=S,this.editionService=T,this.data={items:[],totalCount:0},this.selectedModalContent={},this.visibleFeatures=!1,this.isVisibleSetTenantPasswordModal=!1,this.selectedTenantId="",this.selectedTenantNameForSetTenantPasswordModal="",this.modalBusy=!1,this.emptyOption={label:"-",value:null},this.connectionStringsReplacementKey="Saas.ConnectionStringsComponent",this.setTenantPasswordReplacementKey="Saas.SetTenantPasswordComponent",this.activationStateOptions=ye,this.setTenantReplaceableTemplateOptions=null,this.onVisibleFeaturesChange=C=>{this.visibleFeatures=C},this.closeSetTenantPasswordModal=()=>{this.isVisibleSetTenantPasswordModal=!1,this.selectedTenantNameForSetTenantPasswordModal="",this.selectedTenantId="",this.setTenantReplaceableTemplateOptions=null}}ngOnInit(){this.buildForm(),this.hookToQuery()}clearFilters(){this.formFilters.reset()}hookToQuery(){this.list.hookToQuery(t=>{const i={...this.formFilters.value,...this.formFilters.value.times};return this.service.getList({...t,...i})}).subscribe(t=>this.data=t)}createTenantForm(){return this.editionService.getList({maxResultCount:1e3}).pipe((0,x.b)(t=>{this.editions=t.items;const i=new c.lg(this.injector,this.selected);this.tenantForm=(0,c.se)(i),i.record?.editionId||this.tenantForm.controls.editionId.patchValue(null)}))}openModal(t,i,a){this.selectedModalContent={title:t,template:i,type:a},this.isModalVisible=!0}onEditConnectionString(t){this.selected=t,this.openModal("Saas::ConnectionStrings",this.connectionStringModalTemplate,"saveConnStr")}onAddTenant(){this.selected={},this.createTenantForm().subscribe(()=>this.openModal("Saas::NewTenant",this.tenantModalTemplate,"saveTenant"))}onEditTenant(t){this.service.get(t).subscribe(i=>{this.selected=i,this.createTenantForm().subscribe(()=>this.openModal("Saas::Edit",this.tenantModalTemplate,"saveTenant"))})}save(){const{type:t}=this.selectedModalContent||{};"saveTenant"!==t?"saveConnStr"===t&&this.saveConnectionString():this.saveTenant()}saveConnectionString(){this.modalBusy||this.connectionStringsRef.form.invalid||this.service.updateConnectionStrings(this.selected.id,this.connectionStringsRef.getInput()).pipe((0,A.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.list.get()})}saveTenant(){if(!this.tenantForm.valid||this.modalBusy)return;this.modalBusy=!0;const{activationEndDate:t}=this.tenantForm.value,i={...this.tenantForm.value,...t&&{activationEndDate:new Date(t).toLocalISOString()},...!this.selected.id&&{connectionStrings:this.connectionStringsRef.getInput()}},{id:a}=this.selected;(a?this.service.update(a,{...this.selected,...i}):this.service.create(i)).pipe((0,A.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.list.get(),this.isModalVisible=!1})}delete(t,i){this.confirmationService.warn("Saas::TenantDeletionConfirmationMessage","Saas::AreYouSure",{messageLocalizationParams:[i]}).subscribe(a=>{a===p.Tv.Status.confirm&&this.service.delete(t).subscribe(()=>this.list.get())})}onSharedDatabaseChange(t){t||setTimeout(()=>{const i=document.getElementById("defaultConnectionString");i&&i.focus()},0)}openFeaturesModal(t){this.providerKey=t,setTimeout(()=>{this.visibleFeatures=!0},0)}openSetTenantPasswordModal(t,i){this.isVisibleSetTenantPasswordModal=!0,this.selectedTenantNameForSetTenantPasswordModal=i,this.selectedTenantId=t,this.setTenantReplaceableTemplateOptions={outputs:{modalVisibleChange:this.closeSetTenantPasswordModal},inputs:{modalVisible:{value:this.isVisibleSetTenantPasswordModal},tenantId:{value:this.selectedTenantId},tenantName:{value:this.selectedTenantNameForSetTenantPasswordModal}},componentKey:this.setTenantPasswordReplacementKey}}applyDatabaseMigrations(t){this.service.applyDatabaseMigrations(t).subscribe(()=>this.toaster.info("Saas::DatabaseMigrationQueuedAndWillBeApplied","",{life:6e3}))}buildForm(){this.formFilters=this.fb.group({getEditionNames:[null,[]],editionId:[null,[]],times:[{}],activationState:[null,[]]})}getData(){this.formFilters.invalid&&this.formFilters.touched||this.list.get()}getEditionLookup(){return()=>this.service.getEditionLookup().pipe((0,Z.U)(t=>({items:t})))}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(l.XNV),e.Y36(p.YP),e.Y36(E),e.Y36(s.QS),e.Y36(e.zs3),e.Y36(p.MJ),e.Y36(y))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["abp-tenants"]],viewQuery:function(i,a){if(1&i&&(e.Gf(L,5),e.Gf(_t,5),e.Gf(gt,5)),2&i){let r;e.iGM(r=e.CRH())&&(a.connectionStringsRef=r.first),e.iGM(r=e.CRH())&&(a.tenantModalTemplate=r.first),e.iGM(r=e.CRH())&&(a.connectionStringModalTemplate=r.first)}},features:[e._Bn([l.XNV,{provide:c.ex,useValue:"Saas.TenantsComponent"},{provide:g.DO,useClass:p._A}])],decls:59,vars:52,consts:[[3,"title","toolbar"],["id","wrapper"],["localizationSourceName","Saas",3,"list"],[3,"formGroup"],["filterForm",""],[1,"row"],[1,"col-12","col-sm-3"],[1,"mb-3"],["for","editionIdFilter",1,"form-label"],["cid","editionIdFilter","formControlName","editionId",3,"emptyOption","getFn"],[1,"form-label",3,"ngbTooltip"],["aria-hidden","true",1,"fa","fa-info-circle"],["formControlName","times","startDateProp","fromDate","endDateProp","toDate"],["for","activationState",1,"form-label"],["id","activationState","formControlName","activationState",1,"form-select","form-control"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-12","col-sm-auto","align-self-end","mb-3"],[1,"col-6","col-sm-auto","d-grid"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"card"],[3,"data","recordsTotal","list"],[3,"visible","busy","options","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[4,"ngIf"],["tenantModalTemplate",""],["connectionStringModalTemplate",""],["providerName","T",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[4,"ngTemplateOutlet"],["abpClose","","type","button",1,"btn","btn-secondary"],[3,"ngSwitch"],["iconClass","fa fa-check","buttonType","submit","formName","editOrCreateForm",4,"ngSwitchCase"],["iconClass","fa fa-check",3,"disabled","click",4,"ngSwitchCase"],["iconClass","fa fa-check","buttonType","submit","formName","editOrCreateForm"],["iconClass","fa fa-check",3,"disabled","click"],[3,"modalVisible","tenantId","tenantName","modalVisibleChange",4,"abpReplaceableTemplate"],[3,"modalVisible","tenantId","tenantName","modalVisibleChange"],["createTenantTmp",""],["tenantFormTmp",""],["connectionStrings",""],["ngbNav","",1,"nav-tabs",3,"destroyOnHide"],["nav","ngbNav"],["ngbNavItem",""],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],["class","py-2","id","editOrCreateForm","validateOnSubmit","",3,"formGroup","ngSubmit",4,"ngIf"],["id","editOrCreateForm","validateOnSubmit","",1,"py-2",3,"formGroup","ngSubmit"],[3,"selectedRecord"],[3,"formSubmit",4,"abpReplaceableTemplate"],[3,"formSubmit"],[3,"selectedTenant","formSubmit",4,"abpReplaceableTemplate"],[3,"selectedTenant","formSubmit"],["providerName","T",3,"visible","providerKey","visibleChange"]],template:function(i,a){1&i&&(e.TgZ(0,"abp-page",0),e.ALo(1,"abpLocalization"),e.TgZ(2,"div",1)(3,"abp-advanced-entity-filters",2)(4,"abp-advanced-entity-filters-form")(5,"form",3,4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"label",8),e._uU(11),e.ALo(12,"abpLocalization"),e.qZA(),e._UZ(13,"abp-lookup-select",9),e.qZA()(),e.TgZ(14,"div",6)(15,"div",7)(16,"label",10),e.ALo(17,"abpLocalization"),e._uU(18),e.ALo(19,"abpLocalization"),e._UZ(20,"i",11),e.qZA(),e._UZ(21,"abp-date-range-picker",12),e.qZA()(),e.TgZ(22,"div",6)(23,"div",7)(24,"label",13),e._uU(25),e.ALo(26,"abpLocalization"),e.qZA(),e.TgZ(27,"select",14)(28,"option",15),e._uU(29,"-"),e.qZA(),e.YNc(30,ht,3,4,"option",16),e.qZA()()(),e.TgZ(31,"div",17)(32,"div",5)(33,"div",18)(34,"button",19),e.NdJ("click",function(){return a.clearFilters()}),e.TgZ(35,"span"),e._uU(36),e.ALo(37,"abpLocalization"),e.qZA()()(),e.TgZ(38,"div",18)(39,"button",20),e.NdJ("click",function(){return a.getData()}),e.TgZ(40,"span"),e._uU(41),e.ALo(42,"abpLocalization"),e.qZA()()()()()()()()(),e.TgZ(43,"div",21),e._UZ(44,"abp-extensible-table",22),e.qZA()()(),e.TgZ(45,"abp-modal",23),e.NdJ("visibleChange",function(d){return a.isModalVisible=d}),e.YNc(46,bt,3,3,"ng-template",null,24,e.W1O)(48,Tt,1,1,"ng-template",null,25,e.W1O)(50,Ct,6,6,"ng-template",null,26,e.W1O),e.qZA(),e.YNc(52,xt,2,1,"ng-container",27)(53,Ut,7,1,"ng-template",null,28,e.W1O)(55,Rt,1,11,"ng-template",null,29,e.W1O)(57,kt,1,2,"abp-feature-management",30),e._UZ(58,"abp-impersonate-tenant-modal")),2&i&&(e.Q6J("title",e.lcZ(1,23,"Saas::Tenants"))("toolbar",a.data.items),e.xp6(3),e.Q6J("list",a.list),e.xp6(2),e.Q6J("formGroup",a.formFilters),e.xp6(6),e.hij(" ",e.lcZ(12,25,"Saas::Edition")," "),e.xp6(2),e.Q6J("emptyOption",a.emptyOption)("getFn",a.getEditionLookup()),e.xp6(3),e.Q6J("ngbTooltip",e.lcZ(17,27,"Saas::EditionEndDateToolTip")),e.xp6(2),e.hij(" ",e.lcZ(19,29,"Saas::DisplayName:ExpirationDate")," "),e.xp6(7),e.Oqu(e.lcZ(26,31,"Saas::DisplayName:ActivationState")),e.xp6(3),e.Q6J("ngValue",null),e.xp6(2),e.Q6J("ngForOf",a.activationStateOptions),e.xp6(6),e.Oqu(e.lcZ(37,33,"AbpUi::Clear")),e.xp6(3),e.Q6J("disabled",a.formFilters.invalid),e.xp6(2),e.Oqu(e.lcZ(42,35,"AbpUi::Refresh")),e.xp6(3),e.Q6J("data",a.data.items)("recordsTotal",a.data.totalCount)("list",a.list),e.xp6(1),e.Q6J("visible",a.isModalVisible)("busy",a.modalBusy)("options",e.DdM(37,Vt)),e.xp6(7),e.Q6J("ngIf",a.setTenantReplaceableTemplateOptions),e.xp6(5),e.Q6J("abpReplaceableTemplate",e.WLB(49,se,e.kEZ(43,ae,e.DdM(38,zt),e.VKq(39,V,a.providerKey),e.VKq(41,ie,a.visibleFeatures)),e.VKq(47,oe,a.onVisibleFeaturesChange))))},dependencies:[_.hL,_.J5,u.sg,u.O5,u.tP,u.RF,u.n9,s._Y,s.YN,s.Kr,s.EJ,s.JJ,s.JL,s.sg,s.u,l.YzZ,l.zLP,b.Fr,b.C_,c.gt,c.m5,b.hE,b.Ii,p.r0,p.zS,p.YM,O.$,M.II,g.uN,g.Pz,g.nv,g.Is,g.Vx,g.tO,g.Dy,g._L,L,z,Q,l.fuE],encapsulation:2})}return n})(),pe=(()=>{class n{constructor(t,i){this.permissionService=t,this.service=i,this.data={},this.initialized=new ee.X(this),this.width=273,this.height=136,this.chartData={},this.draw=()=>{this.permissionService.getGrantedPolicy("Saas.Editions")&&this.service.getUsageStatistics().subscribe(a=>{this.data=a.data,this.setChartData()})}}setChartData(){if(!this.data||"{}"===JSON.stringify(this.data))return void(this.chartData={});const t=Object.keys(this.data);setTimeout(()=>{this.chartData={labels:t,datasets:[{data:t.map(i=>this.data[i]),backgroundColor:(0,F.pc)(Object.keys(this.data).length)}]},this.chart.refresh()},0)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(l.$AH),e.Y36(y))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["abp-editions-usage-widget"]],viewQuery:function(i,a){if(1&i&&e.Gf(F.xH,5),2&i){let r;e.iGM(r=e.CRH())&&(a.chart=r.first)}},inputs:{width:"width",height:"height"},outputs:{initialized:"initialized"},features:[e._Bn([l.FFO])],decls:1,vars:1,consts:[["class","abp-widget-wrapper",4,"abpPermission"],[1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"row"],["type","pie",1,"w-100",3,"data","width","height"],["chart",""]],template:function(i,a){1&i&&e.YNc(0,Yt,10,6,"div",0),2&i&&e.Q6J("abpPermission","Saas.Editions")},dependencies:[l.l97,F.xH,l.fuE],encapsulation:2})}return n})(),me=(()=>{class n{constructor(t,i){this.service=t,this.permissionService=i,this.minHeight=136,this.trackByFn=(a,r)=>r.id,this.draw=()=>{this.permissionService.getGrantedPolicy("Saas.Tenants")&&this.service.getList({getEditionNames:!0,maxResultCount:6,skipCount:0,sorting:"CreationTime desc"}).subscribe(a=>this.data=a.items)}}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(E),e.Y36(l.$AH))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["abp-latest-tenants-widget"]],inputs:{minHeight:"minHeight"},decls:1,vars:1,consts:[["class","abp-widget-wrapper","data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",4,"abpPermission"],["data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"table","table-hover","table-sm"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(i,a){1&i&&e.YNc(0,Bt,21,13,"div",0),2&i&&e.Q6J("abpPermission","Saas.Tenants")},dependencies:[u.sg,l.l97,l.fuE],encapsulation:2})}return n})();const ue=c.uk.createMany([{text:"Saas::Edit",action:n=>{n.getInjected(v).onEditEdition(n.record.id)},permission:"Saas.Editions.Update"},{text:"Saas::Features",action:n=>{n.getInjected(v).openFeaturesModal(n.record.id)},permission:"Saas.Editions.ManageFeatures"},{text:"Saas::ChangeHistory",action:n=>{n.getInjected(b.kv)(n.record.id,"Volo.Saas.Editions.Edition")},permission:"AuditLogging.ViewChangeHistory:Volo.Saas.Edition",visible:n=>!!n.getInjected(b.kv,null)},{text:"Saas::Delete",action:n=>{n.getInjected(v).delete(n.record)},permission:"Saas.Editions.Delete"},{text:"Saas::MoveAllTenants",action:n=>{n.getInjected(v).moveAllTenants(n.record)},permission:"Saas.Tenants.Update"}]),_e=c.QC.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",sortable:!0},{type:"number",name:"tenantCount",displayName:"Saas::TenantCount"}]),B=c.Od.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",validators:()=>[s.Validators.required,s.Validators.maxLength(256)]},{type:"enum",name:"planId",displayName:"Saas::PlanId",visible:n=>!!n.getInjected(v).plans$.value.length,options:n=>n.getInjected(v).plans$.pipe((0,Z.U)(t=>[{key:"-",value:null}].concat(t.map(i=>({key:i.name,value:i.id})))))}]),ge=c.JE.createMany([{text:"Saas::NewEdition",action:n=>{n.getInjected(v).onAddEdition()},permission:"Saas.Editions.Create",icon:"fa fa-plus"}]),he=c.uk.createMany([{text:"Saas::Edit",action:n=>{n.getInjected(f).onEditTenant(n.record.id)},permission:"Saas.Tenants.Update"},{text:"Saas::ConnectionStrings",action:n=>{n.getInjected(f).onEditConnectionString(n.record)},permission:"Saas.Tenants.ManageConnectionStrings"},{text:"Saas::ApplyDatabaseMigrations",action:n=>{n.getInjected(f).applyDatabaseMigrations(n.record.id)},permission:"Saas.Tenants.ManageConnectionStrings",visible:n=>n.record.hasDefaultConnectionString},{text:"Saas::Features",action:n=>{n.getInjected(f).openFeaturesModal(n.record.id)},permission:"Saas.Tenants.ManageFeatures"},{text:"Saas::ChangeHistory",action:n=>{n.getInjected(b.kv)(n.record.id,"Volo.Saas.Tenants.Tenant")},permission:"AuditLogging.ViewChangeHistory:Volo.Saas.Tenant",visible:n=>!!n.getInjected(b.kv,null)},{text:"Saas::LoginWithThisTenant",action:n=>{n.getInjected(Y).show(n.record.id)},permission:"Saas.Tenants.Impersonation",visible:n=>{const t=n.getInjected(l.XJE).getDeep("currentUser.impersonatorUserId"),{activationState:i,activationEndDate:a}=n.record||{},r=i==h.Active,d=i==h.ActiveWithLimitedTime,S=new Date(a)>new Date;return(r||d&&S)&&null===t}},{text:"Saas::ChangePassword",action:n=>{n.getInjected(f).openSetTenantPasswordModal(n.record.id,n.record.name)},permission:"Saas.Tenants.SetPassword"},{text:"Saas::Delete",action:n=>{n.getInjected(f).delete(n.record.id,n.record.name)},permission:"Saas.Tenants.Delete"}]),be=c.QC.createMany([{type:"string",name:"name",displayName:"Saas::TenantName",sortable:!0,columnWidth:300},{type:"string",name:"editionName",displayName:"Saas::EditionName",columnWidth:300},{type:"datetime",name:"editionEndDateUtc",displayName:"Saas::EditionEndDateUtc",columnWidth:300,tooltip:"Saas::EditionEndDateToolTip"},{type:"string",name:"activationState",displayName:"Saas::ActivationState",columnWidth:300,valueResolver:n=>{const o=n.getInjected(l.oQ8),t=n.getInjected(l.XJE),i=n.getInjected(e.soG),{shortDatePattern:a,shortTimePattern:r}=t.getDeep("localization.currentCulture.dateTimeFormat");let d="";switch(n.record.activationState){case h.Active:return d=o.instant("Saas::Enum:TenantActivationState.Active"),(0,N.of)(d);case h.ActiveWithLimitedTime:return d=`${o.instant("Saas::Enum:TenantActivationState.ActiveWithLimitedTime")} (${(0,u.p6)(n.record.activationEndDate,`${a} ${r.replace("tt","a")}`,i)})`,(0,N.of)(d);case h.Passive:return d=o.instant("Saas::Enum:TenantActivationState.Passive"),(0,N.of)(d)}}}]),D=c.Od.createMany([{type:"string",name:"name",id:"name",displayName:"Saas::TenantName",validators:()=>[s.Validators.required,s.Validators.maxLength(256)]},{type:"string",name:"editionId",displayName:"Saas::Edition",id:"edition",disabled:n=>{const o=n.record.editionEndDateUtc;return o&&new Date(o).getTime()<(new Date).getTime()},options:n=>{const o=n.getInjected(f).editions,i={value:null,key:n.getInjected(l.oQ8).instant("AbpUi::NotAssigned")};return(0,N.of)([i,...o.map(a=>({key:a.displayName,value:a.id}))])}},{type:"email",name:"adminEmailAddress",displayName:"Saas::DisplayName:AdminEmailAddress",id:"admin-email-address",validators:()=>[s.Validators.required,s.Validators.maxLength(256),s.Validators.email],formText:"Saas::DisplayName:AdminEmailAddressFormText"},{type:"passwordinputgroup",name:"adminPassword",displayName:"Saas::DisplayName:AdminPassword",id:"admin-password",autocomplete:"new-password",validators:n=>[s.Validators.required,...(0,p.dD)({get:n.getInjected})]},{type:"string",name:"activationState",displayName:"Saas::DisplayName:ActivationState",id:"activation-state",validators:()=>[s.Validators.required],defaultValue:h.Active,options:n=>{const o=n.getInjected(l.oQ8);return(0,N.of)([{key:o.instant("Saas::Enum:TenantActivationState.Active"),value:h.Active},{key:o.instant("Saas::Enum:TenantActivationState.ActiveWithLimitedTime"),value:h.ActiveWithLimitedTime},{key:o.instant("Saas::Enum:TenantActivationState.Passive"),value:h.Passive}])}},{type:"datetime",name:"activationEndDate",displayName:"Saas::DisplayName:ActivationEndDate",id:"activation-end-date",visible:n=>{const{tenantForm:o}=n.getInjected(f);return o.get("activationState").value===h.ActiveWithLimitedTime}}]),fe=[...D.slice(0,2),...D.slice(-2)],Te=c.JE.createMany([{text:"Saas::NewTenant",action:n=>{n.getInjected(f).onAddTenant()},permission:"Saas.Tenants.Create",icon:"fa fa-plus"}]),j={"Saas.EditionsComponent":ue,"Saas.TenantsComponent":he},G={"Saas.EditionsComponent":ge,"Saas.TenantsComponent":Te},W={"Saas.EditionsComponent":_e,"Saas.TenantsComponent":be},H={"Saas.EditionsComponent":B,"Saas.TenantsComponent":D},K={"Saas.EditionsComponent":B,"Saas.TenantsComponent":fe},I=new e.OlP("SAAS_ENTITY_ACTION_CONTRIBUTORS"),w=new e.OlP("SAAS_TOOLBAR_ACTION_CONTRIBUTORS"),U=new e.OlP("SAAS_ENTITY_PROP_CONTRIBUTORS"),q=new e.OlP("SAAS_CREATE_FORM_PROP_CONTRIBUTORS"),J=new e.OlP("SAAS_EDIT_FORM_PROP_CONTRIBUTORS");let jt=(()=>{class n{constructor(t){this.injector=t}canActivate(){const t=this.injector.get(c.X6),i=this.injector.get(I,null)||{},a=this.injector.get(w,null)||{},r=this.injector.get(U,null)||{},d=this.injector.get(q,null)||{},S=this.injector.get(J,null)||{},T=this.injector.get(l.XJE);return(0,c.ot)(T,"Saas").pipe((0,Z.U)(C=>({"Saas.EditionsComponent":C.Edition,"Saas.TenantsComponent":C.Tenant})),(0,c.V_)(T,"Saas"),(0,x.b)(C=>{(0,c.Fr)(t.entityActions,j,i),(0,c.Fr)(t.toolbarActions,G,a),(0,c.Hp)(t.entityProps,W,C.prop,r),(0,c.Hp)(t.createFormProps,H,C.createForm,d),(0,c.Hp)(t.editFormProps,K,C.editForm,S)}),(0,Z.U)(()=>!0))}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(e.zs3))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac})}return n})();const ve=()=>{const n=(0,e.f3M)(e.zs3),o=n.get(c.X6),t=n.get(I,null)||{},i=n.get(w,null)||{},a=n.get(U,null)||{},r=n.get(q,null)||{},d=n.get(J,null)||{},S=n.get(l.XJE);return(0,c.ot)(S,"Saas").pipe((0,Z.U)(T=>({"Saas.EditionsComponent":T.Edition,"Saas.TenantsComponent":T.Tenant})),(0,c.V_)(S,"Saas"),(0,x.b)(T=>{(0,c.Fr)(o.entityActions,j,t),(0,c.Fr)(o.toolbarActions,G,i),(0,c.Hp)(o.entityProps,W,T.prop,a),(0,c.Hp)(o.createFormProps,H,T.createForm,r),(0,c.Hp)(o.editFormProps,K,T.editForm,d)}))},Gt=[{path:"",redirectTo:"tenants",pathMatch:"full"},{path:"",component:l.O39,canActivate:[l.p2e,l.zaK],resolve:[ve],children:[{path:"tenants",component:l.c$y,data:{requiredPolicy:"Saas.Tenants",replaceableComponent:{key:"Saas.TenantsComponent",defaultComponent:f}}},{path:"editions",component:l.c$y,data:{requiredPolicy:"Saas.Editions",replaceableComponent:{key:"Saas.EditionsComponent",defaultComponent:v}}}]}];let Wt=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[ne.Bz.forChild(Gt),ne.Bz]})}return n})(),Ht=(()=>{class n{static forChild(t={}){return{ngModule:n,providers:[{provide:I,useValue:t.entityActionContributors},{provide:w,useValue:t.toolbarActionContributors},{provide:U,useValue:t.entityPropContributors},{provide:q,useValue:t.createFormPropContributors},{provide:J,useValue:t.editFormPropContributors}]}}static forLazy(t={}){return new l.Cgl(n.forChild(t))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[Wt,_.h2,l.IR2,b.vv,p.e2,g.XC,O.XE,M.BG,F.SD,g.Oz,g.dT,b.jE,g.M,g.HK,v,c.hi]})}return n})();const Kt=/^\d{4}-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])*$/}}]);